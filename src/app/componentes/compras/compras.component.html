<div class="container mx-auto my-8 px-4">


  <div class="mb-6">
    <label class="block text-gray-700 font-semibold mb-2">Seleccionar Cliente:</label>
    <select [(ngModel)]="clienteSeleccionado" 
            class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
      <option [ngValue]="undefined">-- Seleccione un cliente --</option>
      <option *ngFor="let c of clientes" [ngValue]="c">{{ c.nombre }}</option>
    </select>
  </div>


  <h2 class="text-3xl font-bold text-blue-700 mb-4">Productos</h2>
  <div class="overflow-x-auto mb-6">
    <table class="min-w-full bg-white rounded-lg shadow-md divide-y divide-gray-200">
      <thead class="bg-blue-700 text-white">
        <tr>
          <th>Código</th>
          <th>Descripción</th>
          <th>Precio</th>
          <th>IVA</th>
          <th>Cantidad Disponible</th>
          <th>Cantidad a Pedir</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of productos">
          <td>{{ p.codigo }}</td>
          <td>{{ p.descripcion }}</td>
          <td>{{ p.precio | currency:'USD':'symbol':'1.2-2' }}</td>
          <td>{{ p.iva_incluido ? 'Sí' : 'No' }}</td>
          <td>{{ p.cantidad_disponible }}</td>
          <td>
            <input type="number" [(ngModel)]="p.cantidad_pedir" min="1" max="{{p.cantidad_disponible}}" class="w-20 p-1 border rounded-md">
          </td>
          <td>
            <button (click)="agregarAlCarrito(p)" class="bg-blue-700 text-white px-2 py-1 rounded-md">
              Agregar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  
  <div *ngIf="carrito.length > 0">
    <h3 class="text-2xl font-semibold text-blue-700 mb-4">Carrito</h3>
    <table class="min-w-full bg-white rounded-lg shadow-md divide-y divide-gray-200 mb-4">
      <thead class="bg-blue-600 text-white">
        <tr>
          <th>Producto</th>
          <th>Cantidad</th>
          <th>Precio Unit</th>
          <th>Subtotal</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of carrito">
          <td>{{ item.descripcion }}</td>
          <td>{{ item.cantidad }}</td>
          <td>{{ item.precio_unit | currency:'USD' }}</td>
          <td>{{ item.sub_total | currency:'USD' }}</td>
          <td>
            <button (click)="quitarDelCarrito(item)" class="bg-red-600 text-white px-2 py-1 rounded-md">
              Quitar
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="text-right">
      <p class="text-xl font-bold">TOTAL: {{ calcularTotal() | currency:'USD' }}</p>
      <button (click)="confirmarPedido()" class="bg-green-600 text-white px-4 py-2 rounded mt-2">
        Confirmar Pedido
      </button>
    </div>
  </div>
</div>
